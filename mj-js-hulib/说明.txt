由网友unLock(395194077)从golang版转制过来。